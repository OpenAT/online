<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

       <!-- FSON Forms: Create form, tree and list view for the checkout fields -->
        <record model="ir.ui.view" id="fson_form_form">
            <field name="name">fso_forms.fson_form form</field>
            <field name="model">fson.form</field>
            <field name="arch" type="xml">
                <form string="FSON Form">
                    <sheet>
                        <group>
                            <group name="basic_form_data">
                                <field name="name"/>
                                <field name="model_id"/>
                                <field name="submit_button_text"/>
                                <field name="logout_button_text"/>
                                <field name="clear_session_data_after_submit"/>
                                <field name="edit_existing_record_if_logged_in"/>
                                <field name="email_only"/>
                                <field name="confirmation_email_template"/>
                                <field name="information_email_receipients" widget="many2many_tags"/>
                                <field name="information_email_template"/>
                            </group>
                            <group name="system_data">
                                <!-- TODO: Show clickable form link -->
                                <field name="id" readonly="True"/>
                                <field name="create_date" readonly="True"/>
                                <field name="write_date" readonly="True"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Form Fields" name="form_fields">
                                <!-- ATTENTION: We pass the current model_id to the context of the inner tree view!
                                                This is the only way without saving first that i found -->
                                <field name="field_ids"
                                       context="{'form_model_id': model_id}">
                                    <tree string="Fields" editable="bottom">
                                        <field name="sequence" widget="handle"/>
                                        <field name="show"/>
                                        <field name="form_model_name" invisible="1"/>
                                        <!-- ATTENTION: The Domain for 'field_id' is also set dynamically by oc_field_id_dynamic_domain() -->
                                        <field name="field_id"
                                               domain="[('model_id','=',context.get('form_model_id'))]"
                                               options="{'no_open': True, 'no_create': True, 'no_create_edit': True, 'no_quick_create': True,}"/>
                                        <field name="field_ttype" invisible="1"/>
                                        <field name="field_model_name" invisible="1"/>
                                        <field name="binary_name_field_id"
                                               attrs="{'readonly': [('field_ttype','!=','binary')]}"
                                               domain="[('model_id','=',context.get('form_model_id')),
                                                        ('ttype','=','char'),
                                                        ('readonly','=',False)]"
                                               options="{'no_create': True, 'no_create_edit': True, 'no_quick_create': True,}"/>
                                        <field name="label"/>
                                        <field name="placeholder" attrs="{'readonly': [('field_ttype','in',['boolean',])]}"/>
                                        <field name="yes_text" attrs="{'readonly': ['|', ('field_ttype','!=','boolean'), ('style', 'not in', ['radio_selectnone', 'radio'])]}"/>
                                        <field name="no_text" attrs="{'readonly': ['|', ('field_ttype','!=','boolean'), ('style', 'not in', ['radio_selectnone', 'radio'])]}"/>
                                        <field name="mandatory"/>
                                        <field name="nodata"/>
                                        <field name="readonly"/>
                                        <field name="login"/>
                                        <field name="confirmation_email" attrs="{'readonly': [('field_ttype','!=','char')]}"/>
                                        <field name="validation_rule"/>
                                        <field name="css_classes"/>
                                        <field name="clearfix"/>
                                        <field name="style" attrs="{'readonly': [('field_ttype','not in',['selection', 'many2one', 'boolean'])]}"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Form-Snippet-Areas" name="form_snippets">
                                <group>
                                    <field name="snippet_area_top"/>
                                    <field name="snippet_area_bottom"/>
                                </group>
                            </page>
                            <page string="Thank You Page">
                                <group>
                                    <field name="thank_you_page_after_submit"/>
                                    <field name="thank_you_page_edit_data_button"/>
                                    <field name="thank_you_page_snippets"/>
                                </group>
                            </page>
                            <page string="Danger Zone">
                                <group>
                                    <field name="frontend_validation"/>
                                    <field name="submission_url"/>
                                    <field name="redirect_url"/>
                                    <field name="custom_css"/>
                                </group>
                            </page>
                        </notebook>
                        
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="fson_form_tree">
            <field name="name">fso_forms.fson_form tree</field>
            <field name="model">fson.form</field>
            <field name="arch" type="xml">
                <tree string="FSON Forms" default_order="sequence">
                    <field name="sequence" widget="handle"/>
                        <field name="name"/>
                        <field name="model_id"/>
                        <field name="frontend_validation"/>
                        <field name="submission_url"/>
                        <field name="redirect_url"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="fson_form_search">
            <field name="name">fso_forms.fson_form search</field>
            <field name="model">fson.form</field>
            <field name="arch" type="xml">
                <search string="FSON Forms Search">
                        <field name="name"/>
                        <field name="model_id"/>
                        <field name="frontend_validation"/>
                        <field name="submission_url"/>
                        <field name="redirect_url"/>
                </search>
            </field>
        </record>
        <!-- now we create the action + use the below created ir.actions.act_window.view to open the correct form view -->
        <record model="ir.actions.act_window" id="fson_form_action">
            <field name="name">FSON Forms</field>
            <field name="res_model">fson.form</field>
            <field name="view_type">form</field>
            <field name="view_mode">form,tree</field>
            <field name="view_id" ref="fson_form_tree"/>
            <field name="search_view_id" ref="fson_form_search"/>
        </record>
        <!-- And we add the Action to a Menu with the shortcut menuitem -->
        <menuitem action="fson_form_action" id="fson_form_menu" parent="base.menu_config" sequence="3400"/>

    </data>
</openerp>
